# AReaL CUA GRPO Training

åŸºäº AReaL æ¡†æ¶çš„ CUA (Click-UI-Action) Agent å¼‚æ­¥è®­ç»ƒç³»ç»Ÿï¼Œä½¿ç”¨ GRPO (Group-wise Reinforcement Policy Optimization) ç®—æ³•è®­ç»ƒ Qwen3-VL-32B-Instruct LoRA æ¨¡å‹ã€‚

## ğŸ“‹ ç›®å½•

- [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [è®­ç»ƒæµç¨‹](#è®­ç»ƒæµç¨‹)
- [ä½¿ç”¨ AReaL çš„ä¼˜åŠ¿](#ä½¿ç”¨-areal-çš„ä¼˜åŠ¿)
- [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AReaL Trainer                               â”‚
â”‚  (FSDP PPO Actor + å¼‚æ­¥ Rollout + è‡ªåŠ¨ä¿å­˜/æ¢å¤)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Model Loader                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   HF Model Loader    â”‚ OR â”‚  Unsloth Loader      â”‚           â”‚
â”‚  â”‚   (éªŒè¯æ¨¡å¼)          â”‚    â”‚  (åŠ é€Ÿæ¨¡å¼, 2x)       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Qwen3-VL-32B-Instruct + LoRA                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Vision LoRA        â”‚  Cross-modal LoRA  â”‚  Language LoRA â”‚  â”‚
â”‚  â”‚  (visual.attn.*)    â”‚  (merger.mlp)      â”‚  (*_proj)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CUAEnvRolloutWorkflow                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Async       â”‚  â”‚ n_samples   â”‚  â”‚ Multi-turn Episode      â”‚  â”‚
â”‚  â”‚ Rollout     â”‚  â”‚ Parallel    â”‚  â”‚ (screenshotâ†’actionâ†’...) â”‚  â”‚
â”‚  â”‚             â”‚  â”‚ Episodes    â”‚  â”‚                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GBox CUA Agent                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GBoxClient  â”‚  â”‚ Coordinate  â”‚  â”‚ Action Execution        â”‚  â”‚
â”‚  â”‚ (VM ç®¡ç†)    â”‚  â”‚ Generator   â”‚  â”‚ (click/swipe/input)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          GRPO                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Group-wise Advantage = (r_i - mean(r_group)) / std(r_group)â”‚â”‚
â”‚  â”‚  Policy Loss = -log Ï€(a|s) Ã— advantage Ã— clip(ratio)       â”‚â”‚
â”‚  â”‚  KL Penalty = Î² Ã— KL(Ï€ || Ï€_ref)                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†ä»“åº“
cd /path/to/rl-cua

# åˆ›å»º .env æ–‡ä»¶
cp env.example .env

# ç¼–è¾‘ .env è®¾ç½® GBOX_API_KEY
echo "GBOX_API_KEY=your_api_key_here" >> .env
```

### 2. ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
# æ„å»ºé•œåƒ
docker build -f Dockerfile.areal.cua -t areal-cua:latest .

# å•å¡è®­ç»ƒ (HF æ¨¡å¼ - éªŒè¯)
docker-compose -f docker-compose.areal.cua.yml up trainer-single

# å•å¡è®­ç»ƒ (Unsloth æ¨¡å¼ - åŠ é€Ÿ)
LOADER=unsloth docker-compose -f docker-compose.areal.cua.yml up trainer-single

# å¤šå¡è®­ç»ƒ (4 GPUs)
docker-compose -f docker-compose.areal.cua.yml up trainer-multi
```

### 3. ç›´æ¥è¿è¡Œ

```bash
# å•å¡ - HF æ¨¡å¼ (éªŒè¯ loss/KL/reward æ˜¯å¦æ­£å¸¸)
./scripts/train_areal_cua_single.sh --loader hf

# å•å¡ - Unsloth æ¨¡å¼ (2x åŠ é€Ÿ)
./scripts/train_areal_cua_single.sh --loader unsloth

# å¤šå¡ - 4 GPUs
./scripts/train_areal_cua_multi.sh --gpus 4 --loader unsloth
```

## âš™ï¸ é…ç½®è¯´æ˜

### å•å¡é…ç½® (`configs/areal_cua_single_gpu.yaml`)

```yaml
# æ ¸å¿ƒé…ç½®
experiment_name: cua-grpo-single
allocation_mode: vllm:d1p1t1+d1p1t1  # vLLM å’Œ trainer å…±äº«å• GPU

# GRPO é…ç½®
gconfig:
  n_samples: 4  # æ¯ä¸ªä»»åŠ¡è¿è¡Œ 4 ä¸ªå¹¶è¡Œ episode (GRPO ç»„å¤§å°)
  temperature: 0.7

# Actor (ç­–ç•¥æ¨¡å‹)
actor:
  path: Qwen/Qwen3-VL-32B-Instruct
  use_lora: true
  kl_ctl: 0.01  # KL æƒ©ç½šç³»æ•°
  lora:
    r: 16
    alpha: 32

# è®­ç»ƒæ•°æ®
train_dataset:
  batch_size: 2  # æ¯æ‰¹ 2 ä¸ªä»»åŠ¡ Ã— 4 episodes = 8 samples
```

### å¤šå¡é…ç½® (`configs/areal_cua_multi_gpu.yaml`)

```yaml
allocation_mode: vllm:d2p1t2+d4p1t4  # vLLM 2 GPUs, trainer 4 GPUs

vllm:
  tensor_parallel_size: 2

train_dataset:
  batch_size: 4  # æ›´å¤§çš„æ‰¹é‡
```

### å…³é”®å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| `gconfig.n_samples` | GRPO ç»„å¤§å°ï¼ˆæ¯ä»»åŠ¡å¹¶è¡Œ episode æ•°ï¼‰ | 4 |
| `actor.kl_ctl` | KL æ•£åº¦æƒ©ç½šç³»æ•° | 0.01 |
| `actor.eps_clip` | PPO clip èŒƒå›´ | 0.2 |
| `actor.lora.r` | LoRA ç§© | 16 |
| `vllm.gpu_memory_utilization` | vLLM GPU å†…å­˜å ç”¨ | 0.35 (å•å¡) / 0.85 (å¤šå¡) |

## ğŸ“Š è®­ç»ƒæµç¨‹

### 1. å…ˆç”¨ HF åŸç”Ÿè·‘é€šï¼ˆéªŒè¯æ¨¡å¼ï¼‰

```bash
# ä½¿ç”¨ HF loader è¿è¡Œå‡ ä¸ª step
./scripts/train_areal_cua_single.sh --loader hf

# æ£€æŸ¥è¾“å‡º:
# - Reward: åº”è¯¥åœ¨ 0-1 ä¹‹é—´å˜åŒ–
# - PG Loss: åº”è¯¥æ˜¯æ­£å¸¸çš„æ•°å€¼ï¼ˆä¸æ˜¯ nan/infï¼‰
# - KL: åº”è¯¥æ˜¯å°çš„æ­£æ•°ï¼ˆ~0.001-0.1ï¼‰
```

### 2. ç¡®è®¤ loss / KL / reward æ­£å¸¸

è®­ç»ƒè¾“å‡ºç¤ºä¾‹ï¼š
```
[10:30:45] Step 5/100 (5.0%) | Epoch 1 Step 5/20 | Reward: 0.250 | PG Loss: 0.0234 | KL: 0.0078 | LR: 1.00e-05
[GRPO Group 0] Rewards: ['0.000', '1.000', '0.000', '0.000'] | Mean: 0.250 | Std: 0.433
```

- âœ… `Reward`: æœ‰ 0 å’Œ 1 çš„å˜åŒ–è¯´æ˜ episode æœ‰æˆåŠŸ/å¤±è´¥
- âœ… `PG Loss`: åœ¨ 0.001-1.0 èŒƒå›´å†…æ­£å¸¸
- âœ… `KL`: åœ¨ 0.001-0.1 èŒƒå›´å†…æ­£å¸¸
- âœ… `GRPO Group`: ç»„å†…æœ‰ reward å·®å¼‚

### 3. åˆ‡æ¢åˆ° Unsloth åŠ é€Ÿ

```bash
# ç¡®è®¤ HF æ¨¡å¼æ­£å¸¸åï¼Œåˆ‡æ¢åˆ° Unsloth
./scripts/train_areal_cua_single.sh --loader unsloth

# é¢„æœŸ:
# - è®­ç»ƒé€Ÿåº¦æå‡ ~2x
# - å†…å­˜ä½¿ç”¨é™ä½
# - Loss/KL/Reward å˜åŒ–è¶‹åŠ¿ä¸ HF æ¨¡å¼ä¸€è‡´
```

## ğŸ¯ ä½¿ç”¨ AReaL çš„ä¼˜åŠ¿

### 1. å¼‚æ­¥ Rollout
- å¤šä¸ª GBox ç¯å¢ƒå¹¶è¡Œè¿è¡Œ
- Rollout å’Œè®­ç»ƒå¯ä»¥é‡å 
- æé«˜ GPU åˆ©ç”¨ç‡

### 2. è‡ªåŠ¨ä¿å­˜ä¸æ¢å¤
```yaml
saver:
  freq_epochs: 1
  freq_steps: 10  # æ¯ 10 æ­¥ä¿å­˜

recover:
  mode: auto  # è‡ªåŠ¨ä»æœ€æ–° checkpoint æ¢å¤
```

### 3. vLLM é›†æˆ
- AReaL ç®¡ç† vLLM æœåŠ¡å™¨
- æ”¯æŒ LoRA çƒ­åŠ è½½
- æƒé‡æ›´æ–°è‡ªåŠ¨åŒæ­¥

### 4. åˆ†å¸ƒå¼è®­ç»ƒ
- FSDP è‡ªåŠ¨åˆ†ç‰‡
- å¤šå¡ DDP æ”¯æŒ
- NCCL é€šä¿¡ä¼˜åŒ–

## ğŸ“ æ–‡ä»¶ç»“æ„

```
rl-cua/
â”œâ”€â”€ train_areal_cua.py              # ä¸»è®­ç»ƒå…¥å£
â”œâ”€â”€ cua_agent/
â”‚   â”œâ”€â”€ areal_cua_workflow.py       # AReaL Rollout Workflow
â”‚   â”œâ”€â”€ model_loader.py             # HF/Unsloth Model Loader
â”‚   â”œâ”€â”€ tasks.py                    # CUA ä»»åŠ¡å®šä¹‰
â”‚   â”œâ”€â”€ reward.py                   # å¥–åŠ±å‡½æ•°
â”‚   â””â”€â”€ dataset.py                  # æ•°æ®é›†å¤„ç†
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ areal_cua_single_gpu.yaml   # å•å¡é…ç½®
â”‚   â””â”€â”€ areal_cua_multi_gpu.yaml    # å¤šå¡é…ç½®
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ train_areal_cua_single.sh   # å•å¡å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ train_areal_cua_multi.sh    # å¤šå¡å¯åŠ¨è„šæœ¬
â”œâ”€â”€ Dockerfile.areal.cua            # Docker é•œåƒ
â””â”€â”€ docker-compose.areal.cua.yml    # Docker Compose
```

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æŸ¥çœ‹è®­ç»ƒæ—¥å¿—ï¼Ÿ

```bash
# è¾“å‡ºç›®å½•
ls -la outputs/areal_cua_single/

# Tensorboard (å¦‚æœå¯ç”¨)
tensorboard --logdir outputs/areal_cua_single/stats

# æˆªå›¾è½¨è¿¹
ls outputs/areal_cua_single/trace/
```

### Q: å¦‚ä½•è°ƒæ•´ GBox å¹¶å‘æ•°ï¼Ÿ

```yaml
# åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹
rollout:
  max_concurrent_rollouts: 16  # å¢åŠ å¹¶å‘ GBox VMs

gconfig:
  n_samples: 8  # å¢åŠ  GRPO ç»„å¤§å°

train_dataset:
  batch_size: 4  # å¢åŠ æ‰¹é‡å¤§å°
```

### Q: è®­ç»ƒæ—¶ OOM æ€ä¹ˆåŠï¼Ÿ

```yaml
# 1. å‡å°‘ vLLM å†…å­˜å ç”¨
vllm:
  gpu_memory_utilization: 0.25

# 2. å‡å°‘æ‰¹é‡å¤§å°
train_dataset:
  batch_size: 1

# 3. å¯ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹
actor:
  gradient_checkpointing: true
```

### Q: å¦‚ä½•ä» checkpoint æ¢å¤ï¼Ÿ

```yaml
# å¯ç”¨è‡ªåŠ¨æ¢å¤
recover:
  mode: auto
  experiment_name: cua-grpo-single
  trial_name: trial0
```

æˆ–æ‰‹åŠ¨æŒ‡å®šï¼š
```bash
python train_areal_cua.py \
    --config configs/areal_cua_single_gpu.yaml \
    --recover.mode=resume \
    --recover.ckpt_path=/path/to/checkpoint
```

### Q: å¦‚ä½•ç›‘æ§ GRPO ç»„ç»Ÿè®¡ï¼Ÿ

æŸ¥çœ‹æ—¥å¿—ä¸­çš„ `[GRPO Group]` è¾“å‡ºï¼š
```
[GRPO Group 0] Rewards: ['0.000', '1.000', '0.000', '0.000'] | Mean: 0.250 | Std: 0.433
[GRPO Group 1] Rewards: ['1.000', '1.000', '0.000', '1.000'] | Mean: 0.750 | Std: 0.433
```

- åŒç»„å†… reward å·®å¼‚å¤§ â†’ GRPO advantage æœ‰ä¿¡å·
- ç»„é—´ reward å˜åŒ– â†’ æ¨¡å‹åœ¨å­¦ä¹ 

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æ¨¡å¼ | è®­ç»ƒé€Ÿåº¦ | å†…å­˜ä½¿ç”¨ | æ¨èåœºæ™¯ |
|------|----------|----------|----------|
| HF Loader | 1x | é«˜ | éªŒè¯/è°ƒè¯• |
| Unsloth Loader | 2x | ä½ | æ­£å¼è®­ç»ƒ |

## ğŸ”— ç›¸å…³é“¾æ¥

- [AReaL æ¡†æ¶](https://github.com/inclusionai/areal)
- [GBox CUA](https://github.com/babelcloud/gbox-cua)
- [Unsloth](https://github.com/unslothai/unsloth)
- [Qwen3-VL](https://huggingface.co/Qwen/Qwen3-VL-32B-Instruct)

